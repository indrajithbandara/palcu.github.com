---
layout: post
title: Dotfiles and dev tools provisioned by Ansible
date: '2014-06-22T15:16:00.002+03:00'
author: Alex Palcuie
tags:
- automation
- ansible
- dotfiles
- ops
modified_time: '2014-07-05T12:28:20.133+03:00'
thumbnail: http://4.bp.blogspot.com/-Bd3K-2lcu-8/U6a3QDqmX7I/AAAAAAAAK3E/vQEXYXoFYkk/s72-c/forktocat.jpg
blogger_id: tag:blogger.com,1999:blog-4563358888205449053.post-9142792968941059611
blogger_orig_url: http://palcu.blogspot.com/2014/06/dotfiles-and-dev-tools-provisioned-by.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Bd3K-2lcu-8/U6a3QDqmX7I/AAAAAAAAK3E/vQEXYXoFYkk/s1600/forktocat.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-Bd3K-2lcu-8/U6a3QDqmX7I/AAAAAAAAK3E/vQEXYXoFYkk/s1600/forktocat.jpg" height="117" width="200" /></a></div>Lots of nights and years of potential productive work have programmers have lost, by procrastinating on configuring their&nbsp;<a href="https://dotfiles.github.io/">dotfiles</a>. These simple invisible files may seem pointless for a novice, but in the hands of an expert they become a swiss army knife. I'm no exception and I've used the occasion of receiving a new laptop for learning more about Ansible and tweaking those <a href="https://github.com/palcu/dotfiles">files</a>.<br /><a name='more'></a><br /><h3>Ansible</h3>Is an open-source platform for configuring and managing computers. Usually ops people use it &nbsp;to configure farms of servers. You need to be able to spin up dozens of machines, and configure them to be load balancers, db nodes, web apps or whatever is your need. But you can also configure your laptop using them. Puppet and Chef are the other rivals, each with their own pros and cons.<br /><br />I prefer to view all these tools like "Bash on steroids". You could in theory do the same things by writing a script file that installs the dependencies, copies the configurations and starts the services. But what happens if the script fails in the middle? Now you have to take into account that you have to re-run your script, and must force copying the files you did already. And how do you know your packages installed successfully? Instead of writing a bunch of ifs in a shell script, why not use a proper tool.<br /><br />For configuring a Mac machine you can also use&nbsp;<a href="https://boxen.github.com/">Boxen</a>&nbsp;from Github (written in Puppet),&nbsp;<a href="https://github.com/kitchenplan/kitchenplan">Kitchenplan</a>&nbsp;(written in Chef),&nbsp;<a href="https://github.com/spencergibb/battleschool">Battleschool</a>&nbsp;(written in Ansible) or lots of other&nbsp;<a href="https://news.ycombinator.com/item?id=5228479">tools</a>. I've written my own playbooks because I wanted to learn Ansible :-)<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-VXED_6sbhIc/U6a4g9ISBXI/AAAAAAAAK3Q/OtRJ1slXT28/s1600/Screen+Shot+2014-06-22+at+14.04.58.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-VXED_6sbhIc/U6a4g9ISBXI/AAAAAAAAK3Q/OtRJ1slXT28/s1600/Screen+Shot+2014-06-22+at+14.04.58.png" height="640" width="432" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Ansible provisioning my laptop</td></tr></tbody></table><h3>My <a href="https://github.com/palcu/dotfiles/blob/master/home/.vimrc">.vimrc</a></h3>There was once a time when I used to spend my life in VIM. But now, it's only the occasionall tinkering with <i>/etc/hosts</i>&nbsp;or opening another configuration file that makes me use it.<br /><br />My most used shortcut by far is:<br /><br /><span style="background-color: white; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">cmap </span><span class="k" style="background-color: white; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; font-weight: bold; line-height: 18px; white-space: pre;">w</span><span class="p" style="background-color: white; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">!!</span><span style="background-color: white; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"> </span><span class="k" style="background-color: white; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; font-weight: bold; line-height: 18px; white-space: pre;">w</span><span style="background-color: white; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;"> </span><span class="p" style="background-color: white; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">!</span><span style="background-color: white; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">sudo tee % </span><span class="p" style="background-color: white; box-sizing: border-box; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">&gt;</span><span class="sr" style="background-color: white; box-sizing: border-box; color: #009926; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">/dev/</span><span style="background-color: white; color: #333333; font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 12px; line-height: 18px; white-space: pre;">null</span><br /><br />Every time you forget to <i>sudo</i>&nbsp;before opening a file and you do not have the rights to save it, you just <i>:w!!</i>, write the superuser password and the file gets saved. No more copying your code to another file, exiting the current process, opening another one with <i>sudo</i>,&nbsp;pasting everything, maybe indenting... you get the point.<br /><br />Every plugin installs using the wonderful Vundle.vim plugin. You just specify what you want to install, and it fetches it for you. An Ansible play also updates all your plugins, so you live every day on the bleeding edge.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-mYr1YaA-w3g/U6a5HY_JgQI/AAAAAAAAK3Y/THJ8Rc9UToA/s1600/Screen+Shot+2014-06-22+at+14.07.25.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-mYr1YaA-w3g/U6a5HY_JgQI/AAAAAAAAK3Y/THJ8Rc9UToA/s1600/Screen+Shot+2014-06-22+at+14.07.25.png" height="616" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">My VIM terminal, with NERDTree and CtrlP opened</td></tr></tbody></table><h3>ZSH shell</h3>If you are still using Bash, you are living under a rock, seriously. Start reading the <a href="http://hn.algolia.com/#!/story/forever/0/zsh">top articles</a> from the Hacker News crowd. You don't need to read heavy manuals to use it. The shell feels for me natural. I also use <a href="https://github.com/robbyrussell/oh-my-zsh">oh-my-zsh</a>, which has lots of plugins, some nice defaults and you can get inspired to build your own theme. The <i><a href="https://github.com/palcu/dotfiles/blob/master/home/.zshrc">.zshrc</a></i> file is only ~80 lines and has nothing esoteric in it.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-X-qtqwnDY04/U6a9nlORkJI/AAAAAAAAK3w/jMPFw61vaeM/s1600/zsh.gif" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-X-qtqwnDY04/U6a9nlORkJI/AAAAAAAAK3w/jMPFw61vaeM/s1600/zsh.gif" height="456" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">My prompt is pretty basic, but I love to have the Git branch in front of my eyes.</td></tr></tbody></table><h3>tmux vs iTerm2</h3>I once used <a href="http://tmux.sourceforge.net/">tmux</a> to <a href="https://github.com/palcu/dotfiles/blob/7744f2c32a5fc4be6bf0aa19562b9972bd281972/home/.tmux.conf">manage</a> my terminal windows. You SSH into a remote machine, start a session and can arrange 4 split screen windows. If your Internet connection stops, you can SSH back and attach to the same session.<br /><br />But since the Internet connection in Bucharest is solid, and my remote machines are on AWS or DigitalOcean, I just don't need another layer between my terminal app and the shell. But I use <a href="http://www.iterm2.com/">iTerm2</a> to manage my N terminals setup split up on the whole screen, where N tends to be &gt; 5 on some days.<br /><h3>FASD</h3>The most used tool in the shell by me is by far <a href="https://github.com/clvv/fasd">FASD</a>. It compiles a list by using frecency (frequency and recency) of the directories and files, and it starts reading my mind. If I type <i>z feature</i>&nbsp;it will change the directory to&nbsp;<i>~/uberVU/thehole/ubervu/frontend/features</i>&nbsp;and if I type <i>v mac</i>&nbsp;it will open&nbsp;<i>~/dotfiles/playbooks/tasks</i> in Vim. It's my best command line productivity booster, since I've found myself moving between directories all the time.<br /><br /><h3>HomeBrew and Brew Cask</h3>Every programmer that has migrated from the Linux world to the OSX world knows that Apple devies do not have a proper package manager like <i>apt</i>. We use <a href="http://brew.sh/">Brew</a> to install and compile formulas, which means a Ruby installation will take 5-6 minutes and will make your fan to produce a lot of heat. But, it's better than nothing.<br /><br /><a href="http://caskroom.io/">Brew Cask</a> is an attempt to package user apps and install them in batch from the command line. It just works and in minutes you have Spotify, Chrome and other apps installed and symlinked to <i>/Application</i>.<br /><h3><a href="https://github.com/palcu/dotfiles/tree/master/playbooks">Playbooks</a></h3>Are simple YAML files. Here is the <i><a href="https://github.com/palcu/dotfiles/blob/master/playbooks/tasks/sublime_text.yml">sublime_text.yml</a></i> which extensively uses the <i>file</i> module. There are also modules for git, apt, homebrew, pip, raw commands or whatever you may need to configure and deploy a machine.<br /><pre>---<br />- name: Remove Sublime config dir if it exists<br />  file: path=~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User<br />        state=absent<br /><br />- name: Symlink Sublime Text config<br />  file: src=~/dotfiles/configs/sublime_text_3/User<br />        dest=~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User<br />        force=yes<br />        state=link<br /><br />- name: Symlink Sublime Text to subl in terminal<br />  file: src=~/Applications/Sublime\ Text.app/Contents/SharedSupport/bin/subl<br />        dest=/usr/local/bin/subl<br />        state=link</pre><br />I've written a list of tasks and split them in 2: a <a href="https://github.com/palcu/dotfiles/blob/master/playbooks/macosx.yml">playbook</a> executes the tasks that I need to provision a Macbook, and another <a href="https://github.com/palcu/dotfiles/blob/master/playbooks/vagrant.yml">playbook</a> that I use to provision tools on a remote Ubuntu machine or on Vagrants.<br /><br />In writing this article and configuring my machine, I was inspired by:<br /><ul><li><a href="http://dotfiles.github.io/">http://dotfiles.github.io</a></li><li><a href="http://il.luminat.us/blog/2014/04/19/how-i-fully-automated-os-x-with-ansible/">http://il.luminat.us/blog/2014/04/19/how-i-fully-automated-os-x-with-ansible/</a></li><li><a href="http://marvelley.com/blog/2014/04/11/local-provisioning-with-ansible/">http://marvelley.com/blog/2014/04/11/local-provisioning-with-ansible/</a></li><li><a href="https://github.com/spencergibb/battleschool">https://github.com/spencergibb/battleschool</a></li><li><a href="https://github.com/RaymiiOrg/ansible">https://github.com/RaymiiOrg/ansible</a></li><li><a href="https://github.com/vaskas/laptop-ansible">https://github.com/vaskas/laptop-ansible</a></li><li><a href="https://github.com/MWGriffin/ansible-playbooks">https://github.com/MWGriffin/ansible-playbooks</a></li></ul><div><i>You can talk about this article on the <a href="https://news.ycombinator.com/item?id=7927646">HN thread</a>. Some people have suggested there their way of managing the "dotfiles hell".</i><br /><i><br /></i><i>If you liked this article, you may like how I try to automate my<a href="http://palcu.blogspot.ro/2014/02/automate-everything-even-opening-your.html"> mundane tasks dev tasks</a>.</i>
